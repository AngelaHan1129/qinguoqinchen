// src/routes/pentest.routes.js
const ErrorHandler = require('../utils/errorHandler');
const Logger = require('../utils/logger');

class PentestRoutes {
    static register(app, services) {
        const { pentestOrchestrator } = services;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // æ ¸å¿ƒç«¯é»ï¼šåŸ·è¡Œå®Œæ•´æ»²é€æ¸¬è©¦
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        app.post('/pentest/execute/full', ErrorHandler.asyncHandler(async (req, res) => {
            Logger.info('ğŸ¯ æ¥æ”¶å®Œæ•´æ»²é€æ¸¬è©¦è«‹æ±‚');

            const {
                vectorIds,
                intensity,
                targetUrl,
                generateReports = true
            } = req.body;

            // åŸ·è¡Œå®Œæ•´æµç¨‹
            const result = await pentestOrchestrator.executeFullPenetrationTest({
                vectorIds,
                intensity,
                targetUrl,
                generateReports
            });

            res.json(result);
        }));

        Logger.success('âœ… Pentest è·¯ç”±è¨»å†Šå®Œæˆ');
    }
}

module.exports = PentestRoutes;
